"undefined"!=typeof dojo&&(dojo.provide("MochiKit.DOM"),dojo.require("MochiKit.Iter")),"undefined"!=typeof JSAN&&JSAN.use("MochiKit.Iter",[]);try{if("undefined"==typeof MochiKit.Iter)throw""}catch(e){throw"MochiKit.DOM depends on MochiKit.Iter!"}"undefined"==typeof MochiKit.DOM&&(MochiKit.DOM={}),MochiKit.DOM.NAME="MochiKit.DOM",MochiKit.DOM.VERSION="1.3.1",MochiKit.DOM.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"},MochiKit.DOM.toString=function(){return this.__repr__()},MochiKit.DOM.EXPORT=["formContents","currentWindow","currentDocument","withWindow","withDocument","registerDOMConverter","coerceToDOM","createDOM","createDOMFunc","getNodeAttribute","setNodeAttribute","updateNodeAttributes","appendChildNodes","replaceChildNodes","removeElement","swapDOM","BUTTON","TT","PRE","H1","H2","H3","BR","CANVAS","HR","LABEL","TEXTAREA","FORM","STRONG","SELECT","OPTION","OPTGROUP","LEGEND","FIELDSET","P","UL","OL","LI","TD","TR","THEAD","TBODY","TFOOT","TABLE","TH","INPUT","SPAN","A","DIV","ABBR","IMG","getElement","$","computedStyle","getElementsByTagAndClassName","addToCallStack","addLoadEvent","focusOnLoad","setElementClass","toggleElementClass","addElementClass","removeElementClass","swapElementClass","hasElementClass","escapeHTML","toHTML","emitHTML","setDisplayForElement","hideElement","showElement","scrapeText","elementDimensions","elementPosition","setElementDimensions","setElementPosition","getViewportDimensions","setOpacity"],MochiKit.DOM.EXPORT_OK=["domConverters"],MochiKit.DOM.Dimensions=function(t,e){this.w=t,this.h=e},MochiKit.DOM.Dimensions.prototype.repr=function(){var t=MochiKit.Base.repr;return"{w: "+t(this.w)+", h: "+t(this.h)+"}"},MochiKit.DOM.Coordinates=function(t,e){this.x=t,this.y=e},MochiKit.DOM.Coordinates.prototype.repr=function(){var t=MochiKit.Base.repr;return"{x: "+t(this.x)+", y: "+t(this.y)+"}"},MochiKit.DOM.Coordinates.prototype.toString=function(){return this.repr()},MochiKit.Base.update(MochiKit.DOM,{setOpacity:function(t,e){t=MochiKit.DOM.getElement(t),MochiKit.DOM.updateNodeAttributes(t,{style:{opacity:e,"-moz-opacity":e,"-khtml-opacity":e,filter:" alpha(opacity="+100*e+")"}})},getViewportDimensions:function(){var t=new MochiKit.DOM.Dimensions,e=MochiKit.DOM._window,n=MochiKit.DOM._document.body;return e.innerWidth?(t.w=e.innerWidth,t.h=e.innerHeight):n.parentElement.clientWidth?(t.w=n.parentElement.clientWidth,t.h=n.parentElement.clientHeight):n&&n.clientWidth&&(t.w=n.clientWidth,t.h=n.clientHeight),t},elementDimensions:function(t){var e=MochiKit.DOM;if("number"==typeof t.w||"number"==typeof t.h)return new e.Dimensions(t.w||0,t.h||0);if(t=e.getElement(t)){if("none"!=e.computedStyle(t,"display"))return new e.Dimensions(t.offsetWidth||0,t.offsetHeight||0);var n=t.style,i=n.visibility,o=n.position;n.visibility="hidden",n.position="absolute",n.display="";var r=t.offsetWidth,s=t.offsetHeight;return n.display="none",n.position=o,n.visibility=i,new e.Dimensions(r,s)}},elementPosition:function(t,e){var n=MochiKit.DOM;if(t=n.getElement(t)){var i=new n.Coordinates(0,0);if(t.x&&t.y)return i.x+=t.x||0,i.y+=t.y||0,i;if(null!==t.parentNode&&"none"!=n.computedStyle(t,"display")){var o=null,r=null,s=MochiKit.DOM._document,a=s.documentElement,l=s.body;if(t.getBoundingClientRect)o=t.getBoundingClientRect(),i.x+=o.left+(a.scrollLeft||l.scrollLeft)-(a.clientLeft||l.clientLeft),i.y+=o.top+(a.scrollTop||l.scrollTop)-(a.clientTop||l.clientTop);else if(s.getBoxObjectFor)o=s.getBoxObjectFor(t),i.x+=o.x,i.y+=o.y;else if(t.offsetParent){if(i.x+=t.offsetLeft,i.y+=t.offsetTop,r=t.offsetParent,r!=t)for(;r;)i.x+=r.offsetLeft,i.y+=r.offsetTop,r=r.offsetParent;var c=navigator.userAgent.toLowerCase();("undefined"!=typeof opera&&parseFloat(opera.version())<9||-1!=c.indexOf("safari")&&"absolute"==n.computedStyle(t,"position"))&&(i.x-=l.offsetLeft,i.y-=l.offsetTop)}for("undefined"!=typeof e&&(e=arguments.callee(e),e&&(i.x-=e.x||0,i.y-=e.y||0)),r=t.parentNode?t.parentNode:null;r&&"BODY"!=r.tagName&&"HTML"!=r.tagName;)i.x-=r.scrollLeft,i.y-=r.scrollTop,r=r.parentNode?r.parentNode:null;return i}}},setElementDimensions:function(t,e,n){t=MochiKit.DOM.getElement(t),"undefined"==typeof n&&(n="px"),MochiKit.DOM.updateNodeAttributes(t,{style:{width:e.w+n,height:e.h+n}})},setElementPosition:function(t,e,n){t=MochiKit.DOM.getElement(t),"undefined"==typeof n&&(n="px"),MochiKit.DOM.updateNodeAttributes(t,{style:{left:e.x+n,top:e.y+n}})},currentWindow:function(){return MochiKit.DOM._window},currentDocument:function(){return MochiKit.DOM._document},withWindow:function(t,e){var n,i=MochiKit.DOM,o=i._document,r=i._win;try{i._window=t,i._document=t.document,n=e()}catch(s){throw i._window=r,i._document=o,s}return i._window=r,i._document=o,n},formContents:function(t){var e=[],n=[],i=MochiKit.Base,o=MochiKit.DOM;return t="undefined"==typeof t||null===t?o._document:o.getElement(t),i.nodeWalk(t,function(t){var o=t.name;if(i.isNotEmpty(o)){var r=t.nodeName;if("INPUT"==r&&("radio"==t.type||"checkbox"==t.type)&&!t.checked)return null;if("SELECT"==r){if(t.selectedIndex>=0){var s=t.options[t.selectedIndex];return e.push(o),n.push(s.value?s.value:s.text),null}return e.push(o),n.push(""),null}return"FORM"==r||"P"==r||"SPAN"==r||"DIV"==r?t.childNodes:(e.push(o),n.push(t.value||""),null)}return t.childNodes}),[e,n]},withDocument:function(t,e){var n,i=MochiKit.DOM,o=i._document;try{i._document=t,n=e()}catch(r){throw i._document=o,r}return i._document=o,n},registerDOMConverter:function(t,e,n,i){MochiKit.DOM.domConverters.register(t,e,n,i)},coerceToDOM:function(t,e){for(var n=MochiKit.Iter,i=MochiKit.DOM,o=n.iter,r=n.repeat,s=n.imap,a=i.domConverters,l=i.coerceToDOM,c=MochiKit.Base.NotFound;;){if("undefined"==typeof t||null===t)return null;if("undefined"!=typeof t.nodeType&&t.nodeType>0)return t;if(("number"==typeof t||"boolean"==typeof t)&&(t=t.toString()),"string"==typeof t)return i._document.createTextNode(t);if("function"!=typeof t.toDOM){if("function"!=typeof t){var u=null;try{u=o(t)}catch(h){}if(u)return s(l,u,r(e));try{t=a.match(t,e);continue}catch(h){if(h!=c)throw h}return i._document.createTextNode(t.toString())}t=t(e)}else t=t.toDOM(e)}},setNodeAttribute:function(t,e,n){var i={};i[e]=n;try{return MochiKit.DOM.updateNodeAttributes(t,i)}catch(o){}return null},getNodeAttribute:function(t,e){var n=MochiKit.DOM,i=n.attributeArray.renames[e];t=n.getElement(t);try{return i?t[i]:t.getAttribute(e)}catch(o){}return null},updateNodeAttributes:function(t,e){var n=t,i=MochiKit.DOM;if("string"==typeof t&&(n=i.getElement(t)),e){var o=MochiKit.Base.updatetree;if(i.attributeArray.compliant)for(var r in e){var s=e[r];"object"==typeof s&&"object"==typeof n[r]?o(n[r],s):"on"==r.substring(0,2)?("string"==typeof s&&(s=new Function(s)),n[r]=s):n.setAttribute(r,s)}else{var a=i.attributeArray.renames;for(r in e){s=e[r];var l=a[r];"style"==r&&"string"==typeof s?n.style.cssText=s:"string"==typeof l?n[l]=s:"object"==typeof n[r]&&"object"==typeof s?o(n[r],s):"on"==r.substring(0,2)?("string"==typeof s&&(s=new Function(s)),n[r]=s):n.setAttribute(r,s)}}}return n},appendChildNodes:function(t){var e=t,n=MochiKit.DOM;"string"==typeof t&&(e=n.getElement(t));for(var i=[n.coerceToDOM(MochiKit.Base.extend(null,arguments,1),e)],o=MochiKit.Base.concat;i.length;){var r=i.shift();"undefined"==typeof r||null===r||("number"==typeof r.nodeType?e.appendChild(r):i=o(r,i))}return e},replaceChildNodes:function(t){var e=t,n=MochiKit.DOM;"string"==typeof t&&(e=n.getElement(t),arguments[0]=e);for(var i;i=e.firstChild;)e.removeChild(i);return arguments.length<2?e:n.appendChildNodes.apply(this,arguments)},createDOM:function(t,e){var n,i=MochiKit.DOM,o=MochiKit.Base;if("string"==typeof e||"number"==typeof e){var r=o.extend([t,null],arguments,1);return arguments.callee.apply(this,r)}if("string"==typeof t?(e&&"name"in e&&!i.attributeArray.compliant&&(t="<"+t+' name="'+i.escapeHTML(e.name)+'">'),n=i._document.createElement(t)):n=t,e&&i.updateNodeAttributes(n,e),arguments.length<=2)return n;var r=o.extend([n],arguments,2);return i.appendChildNodes.apply(this,r)},createDOMFunc:function(){var t=MochiKit.Base;return t.partial.apply(this,t.extend([MochiKit.DOM.createDOM],arguments))},swapDOM:function(t,e){var n=MochiKit.DOM;t=n.getElement(t);var i=t.parentNode;return e?(e=n.getElement(e),i.replaceChild(e,t)):i.removeChild(t),e},getElement:function(t){var e=MochiKit.DOM;return 1==arguments.length?"string"==typeof t?e._document.getElementById(t):t:MochiKit.Base.map(e.getElement,arguments)},computedStyle:function(t,e,n){2==arguments.length&&(n=e);var i=MochiKit.DOM,o=i.getElement(t),r=i._document;if(o&&o!=r){if(o.currentStyle)return o.currentStyle[e];if("undefined"!=typeof r.defaultView&&null!==r.defaultView){var s=r.defaultView.getComputedStyle(o,null);if("undefined"!=typeof s&&null!==s)return s.getPropertyValue(n)}}},getElementsByTagAndClassName:function(t,e,n){var i=MochiKit.DOM;("undefined"==typeof t||null===t)&&(t="*"),("undefined"==typeof n||null===n)&&(n=i._document),n=i.getElement(n);var o=n.getElementsByTagName(t)||i._document.all;if("undefined"==typeof e||null===e)return MochiKit.Base.extend(null,o);for(var r=[],s=0;s<o.length;s++)for(var a=o[s],l=a.className.split(" "),c=0;c<l.length;c++)if(l[c]==e){r.push(a);break}return r},_newCallStack:function(t,e){var n=function(){for(var n=arguments.callee.callStack,i=0;i<n.length&&n[i].apply(this,arguments)!==!1;i++);if(e)try{this[t]=null}catch(o){}};return n.callStack=[],n},addToCallStack:function(t,e,n,i){var o=MochiKit.DOM,r=t[e],s=r;("function"!=typeof r||"object"!=typeof r.callStack||null===r.callStack)&&(s=o._newCallStack(e,i),"function"==typeof r&&s.callStack.push(r),t[e]=s),s.callStack.push(n)},addLoadEvent:function(t){var e=MochiKit.DOM;e.addToCallStack(e._window,"onload",t,!0)},focusOnLoad:function(t){var e=MochiKit.DOM;e.addLoadEvent(function(){t=e.getElement(t),t&&t.focus()})},setElementClass:function(t,e){var n=MochiKit.DOM,i=n.getElement(t);n.attributeArray.compliant?i.setAttribute("class",e):i.setAttribute("className",e)},toggleElementClass:function(t){for(var e=MochiKit.DOM,n=1;n<arguments.length;n++){var i=e.getElement(arguments[n]);e.addElementClass(i,t)||e.removeElementClass(i,t)}},addElementClass:function(t,e){var n=MochiKit.DOM,i=n.getElement(t),o=i.className;if(0===o.length)return n.setElementClass(i,e),!0;if(o==e)return!1;for(var r=i.className.split(" "),s=0;s<r.length;s++)if(r[s]==e)return!1;return n.setElementClass(i,o+" "+e),!0},removeElementClass:function(t,e){var n=MochiKit.DOM,i=n.getElement(t),o=i.className;if(0===o.length)return!1;if(o==e)return n.setElementClass(i,""),!0;for(var r=i.className.split(" "),s=0;s<r.length;s++)if(r[s]==e)return r.splice(s,1),n.setElementClass(i,r.join(" ")),!0;return!1},swapElementClass:function(t,e,n){var i=MochiKit.DOM.getElement(t),o=MochiKit.DOM.removeElementClass(i,e);return o&&MochiKit.DOM.addElementClass(i,n),o},hasElementClass:function(t,e){for(var n=MochiKit.DOM.getElement(t),i=n.className.split(" "),o=1;o<arguments.length;o++){for(var r=!1,s=0;s<i.length;s++)if(i[s]==arguments[o]){r=!0;break}if(!r)return!1}return!0},escapeHTML:function(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},toHTML:function(t){return MochiKit.DOM.emitHTML(t).join("")},emitHTML:function(t,e){("undefined"==typeof e||null===e)&&(e=[]);for(var n=[t],i=MochiKit.DOM,o=i.escapeHTML,r=i.attributeArray;n.length;)if(t=n.pop(),"string"==typeof t)e.push(t);else if(1==t.nodeType){e.push("<"+t.nodeName.toLowerCase());for(var s=[],a=r(t),l=0;l<a.length;l++){var c=a[l];s.push([" ",c.name,'="',o(c.value),'"'])}for(s.sort(),l=0;l<s.length;l++)for(var u=s[l],h=0;h<u.length;h++)e.push(u[h]);if(t.hasChildNodes()){e.push(">"),n.push("</"+t.nodeName.toLowerCase()+">");var f=t.childNodes;for(l=f.length-1;l>=0;l--)n.push(f[l])}else e.push("/>")}else 3==t.nodeType&&e.push(o(t.nodeValue));return e},setDisplayForElement:function(t,e){var n=MochiKit.Base,i=n.extend(null,arguments,1);MochiKit.Iter.forEach(n.filter(null,n.map(MochiKit.DOM.getElement,i)),function(e){e.style.display=t})},scrapeText:function(t,e){var n=[];return function(t){var e=t.childNodes;if(e)for(var i=0;i<e.length;i++)arguments.callee.call(this,e[i]);var o=t.nodeValue;"string"==typeof o&&n.push(o)}(MochiKit.DOM.getElement(t)),e?n:n.join("")},__new__:function(t){var e=MochiKit.Base;this._document=document,this._window=t,this.domConverters=new e.AdapterRegistry;var n,i=this._document.createElement("span");if(i&&i.attributes&&i.attributes.length>0){var o=e.filter;n=function(t){return o(n.ignoreAttrFilter,t.attributes)},n.ignoreAttr={},MochiKit.Iter.forEach(i.attributes,function(t){n.ignoreAttr[t.name]=t.value}),n.ignoreAttrFilter=function(t){return n.ignoreAttr[t.name]!=t.value},n.compliant=!1,n.renames={"class":"className",checked:"defaultChecked",usemap:"useMap","for":"htmlFor"}}else n=function(t){return t.attributes},n.compliant=!0,n.renames={};this.attributeArray=n;var r=this.createDOMFunc;this.UL=r("ul"),this.OL=r("ol"),this.LI=r("li"),this.TD=r("td"),this.TR=r("tr"),this.TBODY=r("tbody"),this.THEAD=r("thead"),this.TFOOT=r("tfoot"),this.TABLE=r("table"),this.TH=r("th"),this.INPUT=r("input"),this.SPAN=r("span"),this.A=r("a"),this.DIV=r("div"),this.ABBR=r("abbr"),this.IMG=r("img"),this.BUTTON=r("button"),this.TT=r("tt"),this.PRE=r("pre"),this.H1=r("h1"),this.H2=r("h2"),this.H3=r("h3"),this.BR=r("br"),this.HR=r("hr"),this.LABEL=r("label"),this.TEXTAREA=r("textarea"),this.FORM=r("form"),this.P=r("p"),this.SELECT=r("select"),this.OPTION=r("option"),this.OPTGROUP=r("optgroup"),this.LEGEND=r("legend"),this.FIELDSET=r("fieldset"),this.STRONG=r("strong"),this.CANVAS=r("canvas"),this.hideElement=e.partial(this.setDisplayForElement,"none"),this.showElement=e.partial(this.setDisplayForElement,"block"),this.removeElement=this.swapDOM,this.$=this.getElement,this.EXPORT_TAGS={":common":this.EXPORT,":all":e.concat(this.EXPORT,this.EXPORT_OK)},e.nameFunctions(this)}}),MochiKit.DOM.__new__("undefined"==typeof window?this:window),MochiKit.__compat__||(withWindow=MochiKit.DOM.withWindow,withDocument=MochiKit.DOM.withDocument),MochiKit.Base._exportSymbols(this,MochiKit.DOM);