"undefined"!=typeof dojo&&(dojo.provide("MochiKit.Iter"),dojo.require("MochiKit.Base")),"undefined"!=typeof JSAN&&JSAN.use("MochiKit.Base",[]);try{if("undefined"==typeof MochiKit.Base)throw""}catch(e){throw"MochiKit.Iter depends on MochiKit.Base!"}"undefined"==typeof MochiKit.Iter&&(MochiKit.Iter={}),MochiKit.Iter.NAME="MochiKit.Iter",MochiKit.Iter.VERSION="1.3.1",MochiKit.Base.update(MochiKit.Iter,{__repr__:function(){return"["+this.NAME+" "+this.VERSION+"]"},toString:function(){return this.__repr__()},registerIteratorFactory:function(t,r,e,i){MochiKit.Iter.iteratorRegistry.register(t,r,e,i)},iter:function(t,r){var e=MochiKit.Iter;if(2==arguments.length)return e.takewhile(function(t){return t!=r},t);if("function"==typeof t.next)return t;if("function"==typeof t.iter)return t.iter();try{return e.iteratorRegistry.match(t)}catch(i){var n=MochiKit.Base;throw i==n.NotFound&&(i=new TypeError(typeof t+": "+n.repr(t)+" is not iterable")),i}},count:function(t){t||(t=0);var r=MochiKit.Base;return{repr:function(){return"count("+t+")"},toString:r.forwardCall("repr"),next:r.counter(t)}},cycle:function(t){var r=MochiKit.Iter,e=MochiKit.Base,i=[],n=r.iter(t);return{repr:function(){return"cycle(...)"},toString:e.forwardCall("repr"),next:function(){try{var t=n.next();return i.push(t),t}catch(e){if(e!=r.StopIteration)throw e;if(0===i.length)this.next=function(){throw r.StopIteration};else{var o=-1;this.next=function(){return o=(o+1)%i.length,i[o]}}return this.next()}}}},repeat:function(t,r){var e=MochiKit.Base;return"undefined"==typeof r?{repr:function(){return"repeat("+e.repr(t)+")"},toString:e.forwardCall("repr"),next:function(){return t}}:{repr:function(){return"repeat("+e.repr(t)+", "+r+")"},toString:e.forwardCall("repr"),next:function(){if(0>=r)throw MochiKit.Iter.StopIteration;return r-=1,t}}},next:function(t){return t.next()},izip:function(t,r){var e=MochiKit.Base,i=MochiKit.Iter.next,n=e.map(iter,arguments);return{repr:function(){return"izip(...)"},toString:e.forwardCall("repr"),next:function(){return e.map(i,n)}}},ifilter:function(t,r){var e=MochiKit.Base;return r=MochiKit.Iter.iter(r),null===t&&(t=e.operator.truth),{repr:function(){return"ifilter(...)"},toString:e.forwardCall("repr"),next:function(){for(;;){var e=r.next();if(t(e))return e}}}},ifilterfalse:function(t,r){var e=MochiKit.Base;return r=MochiKit.Iter.iter(r),null===t&&(t=e.operator.truth),{repr:function(){return"ifilterfalse(...)"},toString:e.forwardCall("repr"),next:function(){for(;;){var e=r.next();if(!t(e))return e}}}},islice:function(t){var r=MochiKit.Iter,e=MochiKit.Base;t=r.iter(t);var i=0,n=0,o=1,a=-1;return 2==arguments.length?n=arguments[1]:3==arguments.length?(i=arguments[1],n=arguments[2]):(i=arguments[1],n=arguments[2],o=arguments[3]),{repr:function(){return"islice("+["...",i,n,o].join(", ")+")"},toString:e.forwardCall("repr"),next:function(){for(var e;i>a;)e=t.next(),a++;if(i>=n)throw r.StopIteration;return i+=o,e}}},imap:function(t,r,e){var i=MochiKit.Base,n=MochiKit.Iter,o=i.map(n.iter,i.extend(null,arguments,1)),a=i.map,u=n.next;return{repr:function(){return"imap(...)"},toString:i.forwardCall("repr"),next:function(){return t.apply(this,a(u,o))}}},applymap:function(t,r,e){r=MochiKit.Iter.iter(r);var i=MochiKit.Base;return{repr:function(){return"applymap(...)"},toString:i.forwardCall("repr"),next:function(){return t.apply(e,r.next())}}},chain:function(t,r){var e=MochiKit.Iter,i=MochiKit.Base;if(1==arguments.length)return e.iter(arguments[0]);var n=i.map(e.iter,arguments);return{repr:function(){return"chain(...)"},toString:i.forwardCall("repr"),next:function(){for(;n.length>1;)try{return n[0].next()}catch(t){if(t!=e.StopIteration)throw t;n.shift()}if(1==n.length){var r=n.shift();return this.next=i.bind("next",r),this.next()}throw e.StopIteration}}},takewhile:function(t,r){var e=MochiKit.Iter;return r=e.iter(r),{repr:function(){return"takewhile(...)"},toString:MochiKit.Base.forwardCall("repr"),next:function(){var i=r.next();return t(i)||(this.next=function(){throw e.StopIteration},this.next()),i}}},dropwhile:function(t,r){r=MochiKit.Iter.iter(r);var e=MochiKit.Base,i=e.bind;return{repr:function(){return"dropwhile(...)"},toString:e.forwardCall("repr"),next:function(){for(;;){var e=r.next();if(!t(e))break}return this.next=i("next",r),e}}},_tee:function(t,r,e){r.pos[t]=-1;var i=MochiKit.Base,n=i.listMin;return{repr:function(){return"tee("+t+", ...)"},toString:i.forwardCall("repr"),next:function(){var i,o=r.pos[t];return o==r.max?(i=e.next(),r.deque.push(i),r.max+=1,r.pos[t]+=1):(i=r.deque[o-r.min],r.pos[t]+=1,o==r.min&&n(r.pos)!=r.min&&(r.min+=1,r.deque.shift())),i}}},tee:function(t,r){var e=[],i={pos:[],deque:[],max:-1,min:-1};1==arguments.length&&(r=2);var n=MochiKit.Iter;t=n.iter(t);for(var o=n._tee,a=0;r>a;a++)e.push(o(a,i,t));return e},list:function(t){var r=MochiKit.Base;if("function"==typeof t.slice)return t.slice();if(r.isArrayLike(t))return r.concat(t);var e=MochiKit.Iter;t=e.iter(t);var i=[];try{for(;;)i.push(t.next())}catch(n){if(n!=e.StopIteration)throw n;return i}},reduce:function(t,r,e){var i=0,n=e,o=MochiKit.Iter;if(r=o.iter(r),arguments.length<3){try{n=r.next()}catch(a){throw a==o.StopIteration&&(a=new TypeError("reduce() of empty sequence with no initial value")),a}i++}try{for(;;)n=t(n,r.next())}catch(a){if(a!=o.StopIteration)throw a}return n},range:function(){var t=0,r=0,e=1;if(1==arguments.length)r=arguments[0];else if(2==arguments.length)t=arguments[0],r=arguments[1];else{if(3!=arguments.length)throw new TypeError("range() takes 1, 2, or 3 arguments!");t=arguments[0],r=arguments[1],e=arguments[2]}if(0===e)throw new TypeError("range() step must not be 0");return{next:function(){if(e>0&&t>=r||0>e&&r>=t)throw MochiKit.Iter.StopIteration;var i=t;return t+=e,i},repr:function(){return"range("+[t,r,e].join(", ")+")"},toString:MochiKit.Base.forwardCall("repr")}},sum:function(t,r){var e=r||0,i=MochiKit.Iter;t=i.iter(t);try{for(;;)e+=t.next()}catch(n){if(n!=i.StopIteration)throw n}return e},exhaust:function(t){var r=MochiKit.Iter;t=r.iter(t);try{for(;;)t.next()}catch(e){if(e!=r.StopIteration)throw e}},forEach:function(t,r,e){var i=MochiKit.Base;if(arguments.length>2&&(r=i.bind(r,e)),i.isArrayLike(t))try{for(var n=0;n<t.length;n++)r(t[n])}catch(o){if(o!=MochiKit.Iter.StopIteration)throw o}else e=MochiKit.Iter,e.exhaust(e.imap(r,t))},every:function(t,r){var e=MochiKit.Iter;try{return e.ifilterfalse(r,t).next(),!1}catch(i){if(i!=e.StopIteration)throw i;return!0}},sorted:function(t,r){var e=MochiKit.Iter.list(t);return 1==arguments.length&&(r=MochiKit.Base.compare),e.sort(r),e},reversed:function(t){var r=MochiKit.Iter.list(t);return r.reverse(),r},some:function(t,r){var e=MochiKit.Iter;try{return e.ifilter(r,t).next(),!0}catch(i){if(i!=e.StopIteration)throw i;return!1}},iextend:function(t,r){if(MochiKit.Base.isArrayLike(r))for(var e=0;e<r.length;e++)t.push(r[e]);else{var i=MochiKit.Iter;r=i.iter(r);try{for(;;)t.push(r.next())}catch(n){if(n!=i.StopIteration)throw n}}return t},groupby:function(t,r){function e(){a=t.next(),c=r(a)}function i(){var t=a;return a=void 0,t}var n=MochiKit.Base,o=MochiKit.Iter;arguments.length<2&&(r=n.operator.identity),t=o.iter(t);var a,u=void 0,c=void 0,h=!0;return{repr:function(){return"groupby(...)"},next:function(){for(;c==u;)if(e(),h){h=!1;break}return u=c,[c,{next:function(){if(void 0==a&&e(),c!=u)throw o.StopIteration;return i()}}]}}},groupby_as_array:function(t,r){var e=MochiKit.Base,i=MochiKit.Iter;arguments.length<2&&(r=e.operator.identity),t=i.iter(t);for(var n,o=[],a=!0;;){try{var u=t.next(),c=r(u)}catch(h){if(h==i.StopIteration)break;throw h}if(a||c!=n){var f=[];o.push([c,f])}f.push(u),a=!1,n=c}return o},arrayLikeIter:function(t){var r=0;return{repr:function(){return"arrayLikeIter(...)"},toString:MochiKit.Base.forwardCall("repr"),next:function(){if(r>=t.length)throw MochiKit.Iter.StopIteration;return t[r++]}}},hasIterateNext:function(t){return t&&"function"==typeof t.iterateNext},iterateNextIter:function(t){return{repr:function(){return"iterateNextIter(...)"},toString:MochiKit.Base.forwardCall("repr"),next:function(){var r=t.iterateNext();if(null===r||void 0===r)throw MochiKit.Iter.StopIteration;return r}}}}),MochiKit.Iter.EXPORT_OK=["iteratorRegistry","arrayLikeIter","hasIterateNext","iterateNextIter"],MochiKit.Iter.EXPORT=["StopIteration","registerIteratorFactory","iter","count","cycle","repeat","next","izip","ifilter","ifilterfalse","islice","imap","applymap","chain","takewhile","dropwhile","tee","list","reduce","range","sum","exhaust","forEach","every","sorted","reversed","some","iextend","groupby","groupby_as_array"],MochiKit.Iter.__new__=function(){var t=MochiKit.Base;this.StopIteration=new t.NamedError("StopIteration"),this.iteratorRegistry=new t.AdapterRegistry,this.registerIteratorFactory("arrayLike",t.isArrayLike,this.arrayLikeIter),this.registerIteratorFactory("iterateNext",this.hasIterateNext,this.iterateNextIter),this.EXPORT_TAGS={":common":this.EXPORT,":all":t.concat(this.EXPORT,this.EXPORT_OK)},t.nameFunctions(this)},MochiKit.Iter.__new__(),MochiKit.__compat__||(reduce=MochiKit.Iter.reduce),MochiKit.Base._exportSymbols(this,MochiKit.Iter);