!function(t,e,a,n){function o(){t(".shade, .modal .close").on("click",function(){return t(".shade, .modal").hide(),t(".manage-right").removeClass("show"),l.focus(),t(".modal")[0].removeAttribute("tabindex"),t("body").css("overflow","auto"),!1}),t(window).on("keydown",function(e){27===e.keyCode&&(t(".shade, .modal").hide(),t(".manage-right").removeClass("show"),l.focus(),t(".modal")[0].removeAttribute("tabindex"),t("body").css("overflow","auto"))})}function i(){p.showJumpstart||t(".nux-intro").show(),t(".jp-config-list-btn").click(function(){t("#jp-config-list").toggle(),u(),(new Image).src=p.jumpstartStatsURLS.learnmore}),setTimeout(function(){jQuery(".jetpack-message:not( .stay-visible, .jetpack-err )").hide(600)},6e3),t(document).ready(function(){s()});var e=!1;window.onresize=function(){e||(e=!0,u(),setTimeout(function(){e=!1},100))},t(".full-features-btn").click(function(){(new Image).src=p.nuxAdminStatsURLS.learnmore+"-full-features-btn"})}function s(){var a=t(".modal");t(".module h3, .feature a, .configs a, .more-info, .feat h4").on("click keypress",function(n){if(!n.keyCode||13===n.keyCode){n.preventDefault(),t(".shade").show(),a.html(wp.template("modalLoading")({})).fadeIn();var i=t(this).parent(),s=i.data("index"),r=i.data("name");a.empty().html(wp.template("modal")(t.extend(e[s],{name:r}))),l=this,a[0].setAttribute("tabindex","0"),a.focus(),t("body").css("overflow","hidden"),o(),t(".modal header li a.title").on("click",function(){return t(".modal header li a.title").removeClass("active"),t(this).addClass("active"),!1})}})}function r(a,n,o){var i,r,c="",d=[],m="",l=[];for(i=0,r=e.length;r>i;i++)-1!==e[i].feature.indexOf(a)&&(m=e[i].name.toLowerCase(),d.push({index:i,value:m,order:e[i].recommendation_order}));for(d.sort(function(t,e){return t.order===e.order?0:t.order<e.order?-1:1}),i=0,r=d.length;r>i;i++)l.push(e[d[i].index]),l[i].index=d[i].index;for(i=0;i<l.length;i++)"Jumpstart"!==a||l[i].activated?"Jumpstart"!==a&&(c+=wp.template(n)(l[i])):c+=wp.template(n)(l[i]);t(o).append(c),"Jumpstart"===a&&((new Image).src=p.jumpstartStatsURLS.viewed),u(),s()}function u(){var e,a=t(".jp-jumpstart, .module, .jp-support-column-left .widget-text"),n=0;a.css("height","auto"),a.each(function(){e=t(this).outerHeight(),e>n&&(n=e)}),a.css("height",parseInt(n,10)+5+"px")}function c(){t(".dismiss-jumpstart").click(function(){return t("#jump-start-area").hide(600),p.disableJumpStart=!0,p.action="jetpack_jumpstart_ajax",t.post(n.ajaxurl,p,function(t){window.location.hash="refresh"}),t(".nux-intro").show(),(new Image).src=p.jumpstartStatsURLS.dismiss,!1}),t("#jump-start").click(function(){var e,a,o,i;return t(".jumpstart-spinner").show().css("display","block"),t("#jump-start").hide(),t(".dismiss-jumpstart").hide(),p.jumpStartActivate="jump-start-activate",p.action="jetpack_jumpstart_ajax",t("#jp-config-list").hide(),t.post(n.ajaxurl,p,function(n){e=p.jumpstartModules,_.each(e,function(e){a=t('label[for="active-'+e.module_slug+'"].plugin-action__label'),o=e.configure_url,i=t('input[id="active-'+e.module_slug+'"]'),t("#toggle-"+e.module_slug).addClass("activated"),a.html("ACTIVE"),t(i).prop("checked",!0)}),t(".jumpstart-spinner, .jstart, #jumpstart-cta, .manage-cta-inactive").hide(),t(".jumpstart-message, .manage-cta-active").toggle(),t("#jump-start-area").delay(5e3).hide(600),(new Image).src=p.jumpstartStatsURLS.jumpstarted,t(".nux-intro").show(),window.location.hash="refresh"}),!1}),t("#jump-start-deactivate").click(function(){return t(".jumpstart-spinner").show(),p.jumpStartDeactivate="jump-start-deactivate",p.action="jetpack_jumpstart_ajax",t.post(n.ajaxurl,p,function(e){t("#deactivate-success").html(e),t(".jumpstart-spinner").hide(),window.location.hash=""}),!1})}function d(){t(".nux-in").on("keypress click",".form-toggle",function(a){if(13===a.which||"click"===a.type){var o,i=a.target.id,r=t('label[for="'+i+'"].plugin-action__label');p.action="jetpack_admin_ajax",p.thisModuleSlug=i.replace("active-",""),p.toggleModule="nux-toggle-module",o=t("#toggle-"+p.thisModuleSlug).data("index"),r.hide(),t(".module-spinner-"+p.thisModuleSlug).show(),t.post(n.ajaxurl,p,function(a){if(0!==a){if(!0===a.activated?(new Image).src=p.nuxAdminStatsURLS.enabled+",enabled-"+p.thisModuleSlug:(new Image).src=p.nuxAdminStatsURLS.deactivated+",deactivated-"+p.thisModuleSlug,t(".module-spinner-"+a.module).hide(),a.noConfig=_.indexOf(["photon","enhanced-distribution"],a.module),a.index=o,t("#toggle-"+a.module).replaceWith(wp.template("mod-nux")(a)),_.extend(_.findWhere(e,{module:a.module}),a),"manage"===p.thisModuleSlug)return a.activated?(r.show().html("ACTIVE"),t("#manage-row").addClass("activated")):(r.show().html("INACTIVE"),t("#manage-row").removeClass("activated")),t(".manage-cta-inactive").toggle(),void t(".manage-cta-active").toggle();s(),window.location.hash="refresh"}},"json")}})}function m(){t("#nux-performance-security, #nux-traffic").empty(),t("#jump-start-area").hide(),t(".nux-intro").show(),p.action="jetpack_admin_ajax_refresh",p.refreshData="refresh",t.post(n.ajaxurl,p,function(t){e=_.values(t),r("Performance-Security","mod-nux","#nux-performance-security"),r("Traffic","mod-nux","#nux-traffic")},"json")}var l,p;t(document).ready(function(){p={jumpstartModules:n.jumpstart_modules,jumpstartModSlug:n.jumpstart_modules,jumpstartNonce:n.activate_nonce,jumpstartStatsURLS:n.jumpstart_stats_urls,nuxAdminStatsURLS:n.admin_stats_urls,showJumpstart:n.show_jumpstart,adminNonce:n.admin_nonce},i(),r("Performance-Security","mod-nux","#nux-performance-security"),r("Traffic","mod-nux","#nux-traffic"),"1"===p.showJumpstart&&r("Jumpstart","mod-jumpstart","#jp-config-list"),onload=function(){window.location.hash.substr("#refresh")&&m()},c(),d()})}(jQuery,jetpackL10n.modules,jetpackL10n.currentVersion,jetpackL10n);