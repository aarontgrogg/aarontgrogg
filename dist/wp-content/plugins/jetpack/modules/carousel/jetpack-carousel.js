jQuery(document).ready(function(e){var t,a,i,o,s,n,r,l,c,d,p,u,m,f,h,g,j,w,v,_=110,x=e("body").css("overflow"),k=e("html").css("overflow"),b=85,y="";window.innerWidth<=760&&(_=Math.round(window.innerWidth/760*110),40>_&&("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)&&(_=0)),"undefined"==typeof Date.now&&(Date.now=function(){return(new Date).getTime()});var S=function(e){switch(e.which){case 38:e.preventDefault(),o.scrollTop(o.scrollTop()-100);break;case 40:e.preventDefault(),o.scrollTop(o.scrollTop()+100);break;case 39:e.preventDefault(),i.jp_carousel("clearCommentTextAreaValue"),i.jp_carousel("next");break;case 37:case 8:e.preventDefault(),i.jp_carousel("clearCommentTextAreaValue"),i.jp_carousel("previous");break;case 27:e.preventDefault(),i.jp_carousel("clearCommentTextAreaValue"),o.jp_carousel("close")}},C=function(){clearTimeout(d),d=setTimeout(function(){i.jp_carousel("slides").jp_carousel("fitSlide",!0),i.jp_carousel("updateSlidePositions",!0),i.jp_carousel("fitMeta",!0)},200)},D=function(){if(!t){t=e("<div></div>").addClass("jp-carousel-overlay").css({position:"absolute",top:0,right:0,bottom:0,left:0});var d='<a class="jp-carousel-commentlink" href="#">'+jetpackCarouselStrings.comment+"</a>";1===Number(jetpackCarouselStrings.is_logged_in),d=e('<div class="jp-carousel-buttons">'+d+"</div>"),c=e("<h2></h2>"),p=e('<div class="jp-carousel-photo-info"></div>').append(c),h=e("<div></div>").addClass("jp-carousel-image-meta").css({"float":"right","margin-top":"20px",width:"250px"}),h.append(d).append("<ul class='jp-carousel-image-exif' style='display:none;'></ul>").append("<a class='jp-carousel-image-download' style='display:none;'></a>").append("<div class='jp-carousel-image-map' style='display:none;'></div>"),g=e("<div></div>").addClass("jp-carousel-titleanddesc").css({width:"100%","margin-top":h.css("margin-top")});var m='<div id="jp-carousel-comment-form-container">';jetpackCarouselStrings.local_comments_commenting_as&&jetpackCarouselStrings.local_comments_commenting_as.length&&(1!==Number(jetpackCarouselStrings.is_logged_in)&&1===Number(jetpackCarouselStrings.comment_registration)?m+='<div id="jp-carousel-comment-form-commenting-as">'+jetpackCarouselStrings.local_comments_commenting_as+"</div>":(m+='<form id="jp-carousel-comment-form">',m+='<textarea name="comment" class="jp-carousel-comment-form-field jp-carousel-comment-form-textarea" id="jp-carousel-comment-form-comment-field" placeholder="'+jetpackCarouselStrings.write_comment+'"></textarea>',m+='<div id="jp-carousel-comment-form-submit-and-info-wrapper">',m+='<div id="jp-carousel-comment-form-commenting-as">'+jetpackCarouselStrings.local_comments_commenting_as+"</div>",m+='<input type="submit" name="submit" class="jp-carousel-comment-form-button" id="jp-carousel-comment-form-button-submit" value="'+jetpackCarouselStrings.post_comment+'" />',m+='<span id="jp-carousel-comment-form-spinner">&nbsp;</span>',m+='<div id="jp-carousel-comment-post-results"></div>',m+="</div>",m+="</form>")),m+="</div>",j=e(m).css({width:"100%","margin-top":"20px",color:"#999"}),a=e("<div></div>").addClass("jp-carousel-comments").css({width:"100%",bottom:"10px","margin-top":"20px"});var f=e('<div id="jp-carousel-comments-loading"><span>'+jetpackCarouselStrings.loading_comments+"</span></div>").css({width:"100%",bottom:"10px","margin-top":"20px"}),v=e(window).width()-2*_-(h.width()+40);v+="px",w=e("<div></div>").addClass("jp-carousel-left-column-wrapper").css({width:Math.floor(v)}).append(g).append(j).append(a).append(f);var x=e("<div></div>").addClass("jp-carousel-fadeaway");r=e("<div></div>").addClass("jp-carousel-info").css({top:Math.floor(e(window).height()/100*b),left:_,right:_}).append(p).append(h),window.innerWidth<=760?(p.remove().insertAfter(g),r.prepend(w)):r.append(w);var k=e(window).height()-parseInt(r.css("top"),10)+"px";s=e("<div><span></span></div>").addClass("jp-carousel-next-button").css({right:"15px"}),n=e("<div><span></span></div>").addClass("jp-carousel-previous-button").css({left:0}),s.add(n).css({position:"fixed",top:"40px",bottom:k,width:_}),i=e("<div></div>").addClass("jp-carousel").css({position:"absolute",top:0,bottom:k,left:0,right:0}),u=e('<div class="jp-carousel-close-hint"><span>&times;</span></div>').css({position:"fixed"}),o=e("<div></div>").addClass("jp-carousel-wrap").addClass("jp-carousel-transitions"),"white"===jetpackCarouselStrings.background_color&&o.addClass("jp-carousel-light"),o.css({position:"fixed",top:0,right:0,bottom:0,left:0,"z-index":2147483647,"overflow-x":"hidden","overflow-y":"auto",direction:"ltr"}).hide().append(t).append(i).append(x).append(r).append(s).append(n).append(u).appendTo(e("body")).click(function(t){var a=e(t.target),s=a.parents("div.jp-carousel-wrap"),n=s.data("carousel-extra"),l=s.find("div.selected"),c=l.data("attachment-id");if(n=n||[],a.is(i)||a.parents().add(a).is(u))o.jp_carousel("close");else if(a.hasClass("jp-carousel-commentlink"))t.preventDefault(),t.stopPropagation(),e(window).unbind("keydown",S),o.animate({scrollTop:parseInt(r.position().top,10)},"fast"),e("#jp-carousel-comment-form-submit-and-info-wrapper").slideDown("fast"),e("#jp-carousel-comment-form-comment-field").focus();else if(a.hasClass("jp-carousel-comment-login")){var d=jetpackCarouselStrings.login_url+"%23jp-carousel-"+c;window.location.href=d}else if(a.parents("#jp-carousel-comment-form-container").length){var p=e("#jp-carousel-comment-form-comment-field").blur(function(){e(window).bind("keydown",S)}).focus(function(){e(window).unbind("keydown",S)}),m=e("#jp-carousel-comment-form-email-field").blur(function(){e(window).bind("keydown",S)}).focus(function(){e(window).unbind("keydown",S)}),f=e("#jp-carousel-comment-form-author-field").blur(function(){e(window).bind("keydown",S)}).focus(function(){e(window).unbind("keydown",S)}),h=e("#jp-carousel-comment-form-url-field").blur(function(){e(window).bind("keydown",S)}).focus(function(){e(window).unbind("keydown",S)});if(p&&p.attr("id")===a.attr("id"))e(window).unbind("keydown",S),e("#jp-carousel-comment-form-submit-and-info-wrapper").slideDown("fast");else if(a.is('input[type="submit"]')){t.preventDefault(),t.stopPropagation(),e("#jp-carousel-comment-form-spinner").spin("small","white");var g={action:"post_attachment_comment",nonce:jetpackCarouselStrings.nonce,blog_id:n.blog_id,id:c,comment:p.val()};if(!g.comment.length)return void i.jp_carousel("postCommentError",{field:"jp-carousel-comment-form-comment-field",error:jetpackCarouselStrings.no_comment_text});if(1!==Number(jetpackCarouselStrings.is_logged_in)&&(g.email=m.val(),g.author=f.val(),g.url=h.val(),1===Number(jetpackCarouselStrings.require_name_email))){if(!g.email.length||!g.email.match("@"))return void i.jp_carousel("postCommentError",{field:"jp-carousel-comment-form-email-field",error:jetpackCarouselStrings.no_comment_email});if(!g.author.length)return void i.jp_carousel("postCommentError",{field:"jp-carousel-comment-form-author-field",error:jetpackCarouselStrings.no_comment_author})}e.ajax({type:"POST",url:jetpackCarouselStrings.ajaxurl,data:g,dataType:"json",success:function(t){"approved"===t.comment_status?e("#jp-carousel-comment-post-results").slideUp("fast").html('<span class="jp-carousel-comment-post-success">'+jetpackCarouselStrings.comment_approved+"</span>").slideDown("fast"):"unapproved"===t.comment_status?e("#jp-carousel-comment-post-results").slideUp("fast").html('<span class="jp-carousel-comment-post-success">'+jetpackCarouselStrings.comment_unapproved+"</span>").slideDown("fast"):e("#jp-carousel-comment-post-results").slideUp("fast").html('<span class="jp-carousel-comment-post-error">'+jetpackCarouselStrings.comment_post_error+"</span>").slideDown("fast"),i.jp_carousel("clearCommentTextAreaValue"),i.jp_carousel("getComments",{attachment_id:c,offset:0,clear:!0}),e("#jp-carousel-comment-form-button-submit").val(jetpackCarouselStrings.post_comment),e("#jp-carousel-comment-form-spinner").spin(!1)},error:function(){i.jp_carousel("postCommentError",{field:"jp-carousel-comment-form-comment-field",error:jetpackCarouselStrings.comment_post_error})}})}}else a.parents(".jp-carousel-info").length||o.jp_carousel("next")}).bind("jp_carousel.afterOpen",function(){e(window).bind("keydown",S),e(window).bind("resize",C),i.opened=!0,C()}).bind("jp_carousel.beforeClose",function(){var t=e(window).scrollTop();e(window).unbind("keydown",S),e(window).unbind("resize",C),e(window).scrollTop(t)}).bind("jp_carousel.afterClose",function(){history.pushState?history.pushState("",document.title,window.location.pathname+window.location.search):window.location.hash="",y="",i.opened=!1}).on("transitionend.jp-carousel ",".jp-carousel-slide",function(t){if("transform"===t.originalEvent.propertyName){var a=(Date.now()-l)/1e3/t.originalEvent.elapsedTime;o.off("transitionend.jp-carousel"),a>=2&&e(".jp-carousel-transitions").removeClass("jp-carousel-transitions")}}),e(".jp-carousel-wrap").touchwipe({wipeLeft:function(e){e.preventDefault(),i.jp_carousel("next")},wipeRight:function(e){e.preventDefault(),i.jp_carousel("previous")},preventDefaultEvents:!1}),e(".jetpack-likes-widget-unloaded").each(function(){jetpackLikesWidgetQueue.push(this.id)}),s.add(n).click(function(e){e.preventDefault(),e.stopPropagation(),s.is(this)?i.jp_carousel("next"):i.jp_carousel("previous")})}},I={testForData:function(t){return t=e(t),!(!t.length||!t.data("carousel-extra"))},testIfOpened:function(){return!("undefined"==typeof i||"undefined"==typeof i.opened||!i.opened)},openOrSelectSlide:function(t){e(this).jp_carousel("testIfOpened")?i.jp_carousel("selectSlideAtIndex",t):e(this).jp_carousel("open",{start_index:t})},open:function(t){var a={items_selector:".gallery-item [data-attachment-id], .tiled-gallery-item [data-attachment-id]",start_index:0},s=e(this).data("carousel-extra");return s&&(D(s),!i.jp_carousel("testIfOpened"))?(x=e("body").css("overflow"),e("body").css("overflow","hidden"),k=e("html").css("overflow"),e("html").css("overflow","hidden"),v=e(window).scrollTop(),jQuery(".slim-likes-widget").find("iframe").css("display","inline-block").css("width","60px"),o.data("carousel-extra",s),this.each(function(){var s=e(this);t&&e.extend(a,t),-1===a.start_index&&(a.start_index=0),o.trigger("jp_carousel.beforeOpen").fadeIn("fast",function(){o.trigger("jp_carousel.afterOpen"),i.jp_carousel("initSlides",s.find(a.items_selector),a.start_index).jp_carousel("selectSlideAtIndex",a.start_index)}),i.html("")})):void 0},selectSlideAtIndex:function(e){var t=this.jp_carousel("slides"),a=t.eq(e);return 0===a.length&&(a=t.eq(0)),i.jp_carousel("selectSlide",a,!1),this},close:function(){return e("body").css("overflow",x),e("html").css("overflow",k),o.trigger("jp_carousel.beforeClose").fadeOut("fast",function(){o.trigger("jp_carousel.afterClose"),e(window).scrollTop(v)})},next:function(){var e=i.jp_carousel("nextSlide");o.animate({scrollTop:0},"fast"),e&&this.jp_carousel("selectSlide",e)},previous:function(){var e=i.jp_carousel("prevSlide");o.animate({scrollTop:0},"fast"),e&&this.jp_carousel("selectSlide",e)},resetButtons:function(t){t.data("liked")?e(".jp-carousel-buttons a.jp-carousel-like").addClass("liked").text(jetpackCarouselStrings.unlike):e(".jp-carousel-buttons a.jp-carousel-like").removeClass("liked").text(jetpackCarouselStrings.like)},selectedSlide:function(){return this.find(".selected")},setSlidePosition:function(e){return l=Date.now(),this.css({"-webkit-transform":"translate3d("+e+"px,0,0)","-moz-transform":"translate3d("+e+"px,0,0)","-ms-transform":"translate("+e+"px,0)","-o-transform":"translate("+e+"px,0)",transform:"translate3d("+e+"px,0,0)"})},updateSlidePositions:function(e){var t=this.jp_carousel("selectedSlide"),a=i.width(),o=t.width(),s=i.jp_carousel("prevSlide"),n=i.jp_carousel("nextSlide"),r=s.prev(),l=n.next(),c=Math.floor(.5*(a-o));t.jp_carousel("setSlidePosition",c).show(),i.jp_carousel("fitInfo",e);var d=f.is(t.prevAll())?1:-1;1===d?(l.is(s)||l.jp_carousel("setSlidePosition",a+n.width()).show(),r.is(n)||r.jp_carousel("setSlidePosition",-r.width()-o).show()):l.is(s)||l.jp_carousel("setSlidePosition",a+o).show(),s.jp_carousel("setSlidePosition",Math.floor(-s.width()+.75*_)).show(),n.jp_carousel("setSlidePosition",Math.ceil(a-.75*_)).show()},selectSlide:function(t,a){f=this.find(".selected").removeClass("selected");var s,n,r=i.jp_carousel("slides").css({position:"fixed"}),l=e(t).addClass("selected").css({position:"relative"}),d=l.data("attachment-id"),p=i.jp_carousel("prevSlide"),u=i.jp_carousel("nextSlide"),m=p.prev(),h=u.next();i.jp_carousel("loadFullImage",l),c.hide(),0===u.length&&r.length<=2?e(".jp-carousel-next-button").hide():e(".jp-carousel-next-button").show(),0===p.length&&r.length<=2?e(".jp-carousel-previous-button").hide():e(".jp-carousel-previous-button").show(),s=l.add(p).add(m).add(u).add(h).jp_carousel("loadSlide"),r.not(s).hide(),i.jp_carousel("updateSlidePositions",a),i.jp_carousel("resetButtons",l),o.trigger("jp_carousel.selectSlide",[l]),i.jp_carousel("getTitleDesc",{title:l.data("title"),desc:l.data("desc")}),i.jp_carousel("loadLikes",d),i.jp_carousel("updateLikesWidgetVisibility",d),u.length>0&&i.jp_carousel("loadLikes",u.data("attachment-id")),p.length>0&&i.jp_carousel("loadLikes",p.data("attachment-id"));var g=l.data("image-meta");i.jp_carousel("updateExif",g),i.jp_carousel("updateFullSizeLink",l),i.jp_carousel("updateMap",g),i.jp_carousel("testCommentsOpened",l.data("comments-opened")),i.jp_carousel("getComments",{attachment_id:d,offset:0,clear:!0}),e("#jp-carousel-comment-post-results").slideUp(),l.data("caption")?(n=e("<div />").text(l.data("caption")).html(),n===e("<div />").text(l.data("title")).html()&&e(".jp-carousel-titleanddesc-title").fadeOut("fast").empty(),n===e("<div />").text(l.data("desc")).html()&&e(".jp-carousel-titleanddesc-desc").fadeOut("fast").empty(),c.html(l.data("caption")).fadeIn("slow")):c.fadeOut("fast").empty(),e(u).add(p).each(function(){i.jp_carousel("loadFullImage",e(this))}),window.location.hash=y="#jp-carousel-"+d},slides:function(){return this.find(".jp-carousel-slide")},slideDimensions:function(){return{width:e(window).width()-2*_,height:Math.floor(e(window).height()/100*b-60)}},loadSlide:function(){return this.each(function(){var t=e(this);t.find("img").one("load",function(){t.jp_carousel("fitSlide",!1)})})},bestFit:function(){var e,t,a=i.jp_carousel("slideDimensions"),o=this.jp_carousel("originalDimensions"),s=o.width/o.height,n=1,r=1;return o.width>a.width&&(n=a.width/o.width),o.height>a.height&&(r=a.height/o.height),r>n?(e=a.width,t=Math.floor(e/s)):n>r?(t=a.height,e=Math.floor(t*s)):(e=o.width,t=o.height),{width:e,height:t}},fitInfo:function(){var e=this.jp_carousel("selectedSlide"),t=e.jp_carousel("bestFit");return p.css({left:Math.floor(.5*(r.width()-t.width)),width:Math.floor(t.width)}),this},fitMeta:function(t){var a={top:Math.floor(e(window).height()/100*b+5)+"px"},i={width:r.width()-(h.width()+80)+"px"};t?(r.animate(a),w.animate(i)):(r.animate(a),w.css(i))},fitSlide:function(){return this.each(function(){var t=e(this),a=t.jp_carousel("bestFit"),o="css",s=i.jp_carousel("slideDimensions");a.left=0,a.top=Math.floor(.5*(s.height-a.height))+40,t[o](a)})},texturize:function(t){return t=""+t,t=t.replace(/'/g,"&#8217;").replace(/&#039;/g,"&#8217;").replace(/[\u2019]/g,"&#8217;"),t=t.replace(/"/g,"&#8221;").replace(/&#034;/g,"&#8221;").replace(/&quot;/g,"&#8221;").replace(/[\u201D]/g,"&#8221;"),t=t.replace(/([\w]+)=&#[\d]+;(.+?)&#[\d]+;/g,'$1="$2"'),e.trim(t)},initSlides:function(t,a){t.length<2?e(".jp-carousel-next-button, .jp-carousel-previous-button").hide():e(".jp-carousel-next-button, .jp-carousel-previous-button").show(),t.each(function(){var t,a=e(this),o=a.data("orig-size")||"",s=i.jp_carousel("slideDimensions"),n=o.split(","),r=a.data("medium-file")||"",l=a.data("large-file")||"";o={width:parseInt(n[0],10),height:parseInt(n[1],10)},t=a.data("orig-file"),t=i.jp_carousel("selectBestImageSize",{orig_file:t,orig_width:o.width,orig_height:o.height,max_width:s.width,max_height:s.height,medium_file:r,large_file:l}),e(this).data("gallery-src",t)}),0!==a&&(e("<img/>")[0].src=e(t[a]).data("gallery-src"));var o=t.first().closest(".tiled-gallery.type-rectangular").length>0;return t.each(function(t){var s=e(this),n=s.data("attachment-id")||0,r=s.data("comments-opened")||0,l=s.data("image-meta")||{},c=s.data("orig-size")||"",d={width:s[0].naturalWidth,height:s[0].naturalHeight},p=s.data("image-title")||"",u=s.data("image-description")||"",m=s.parents(".gallery-item").find(".gallery-caption").html()||"",f=s.data("gallery-src")||"",h=s.data("medium-file")||"",g=s.data("large-file")||"",j=s.data("orig-file")||"",w=s.parents("div.tiled-gallery-item").find("div.tiled-gallery-caption").html();if(w&&(m=w),n&&c.length){p=i.jp_carousel("texturize",p),u=i.jp_carousel("texturize",u),m=i.jp_carousel("texturize",m);var v=e("<img/>").attr("src","data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7").css("width","100%").css("height","100%"),_=e('<div class="jp-carousel-slide"></div>').hide().css({left:a>t?-1e3:i.width()}).append(v).appendTo(i).data("src",f).data("title",p).data("desc",u).data("caption",m).data("attachment-id",n).data("permalink",s.parents("a").attr("href")).data("orig-size",c).data("comments-opened",r).data("image-meta",l).data("medium-file",h).data("large-file",g).data("orig-file",j).data("thumb-size",d);o&&_.data("preview-image",s.attr("src")).css({"background-image":'url("'+s.attr("src")+'")',"background-size":"100% 100%","background-position":"center center"}),_.jp_carousel("fitSlide",!1)}}),this},selectBestImageSize:function(e){if("object"!=typeof e&&(e={}),"undefined"==typeof e.orig_file)return"";if("undefined"==typeof e.orig_width||"undefined"==typeof e.max_width)return e.orig_file;if("undefined"==typeof e.medium_file||"undefined"==typeof e.large_file)return e.orig_file;var t=document.createElement("a");t.href=e.large_file;var a=null!=t.hostname.match(/^i[\d]{1}.wp.com$/i),o=i.jp_carousel("getImageSizeParts",e.medium_file,e.orig_width,a),s=i.jp_carousel("getImageSizeParts",e.large_file,e.orig_width,a),n=parseInt(s[0],10),r=parseInt(s[1],10),l=parseInt(o[0],10),c=parseInt(o[1],10);return"undefined"!=typeof window.devicePixelRatio&&window.devicePixelRatio>1&&(e.max_width=e.max_width*window.devicePixelRatio,e.max_height=e.max_height*window.devicePixelRatio),n>=e.max_width||r>=e.max_height?e.large_file:l>=e.max_width||c>=e.max_height?e.medium_file:e.orig_file},getImageSizeParts:function(e,t,a){var i=a?e.replace(/.*=([\d]+%2C[\d]+).*$/,"$1"):e.replace(/.*-([\d]+x[\d]+)\..+$/,"$1"),o=i!==e?a?i.split("%2C"):i.split("x"):[t,0];return"9999"===o[0]&&(o[0]="0"),"9999"===o[1]&&(o[1]="0"),o},originalDimensions:function(){var t=e(this).data("orig-size").split(",");return{width:parseInt(t[0],10),height:parseInt(t[1],10)}},format:function(e){return"object"!=typeof e&&(e={}),e.text&&"undefined"!=typeof e.text?e.replacements&&"undefined"!=typeof e.replacements?e.text.replace(/{(\d+)}/g,function(t,a){return"undefined"!=typeof e.replacements[a]?e.replacements[a]:t}):e.text:void 0},shutterSpeed:function(e){var t;return e>=1?Math.round(10*e)/10+"s":(t=Math.round(1/e),"1/"+t+"s")},parseTitleDesc:function(t){return!t.match(" ")&&t.match("_")?"":(e(["CIMG","DSC_","DSCF","DSCN","DUW","GEDC","IMG","JD","MGP","PICT","Imagen","Foto","DSC","Scan","SANY","SAM","Screen Shot [0-9]+"]).each(function(e,a){var i=new RegExp("^"+a);return i.test(t)?void(t=""):void 0}),t)},getTitleDesc:function(t){var a,o="",s="",n="";a=e("div.jp-carousel-titleanddesc","div.jp-carousel-wrap"),a.hide(),o=i.jp_carousel("parseTitleDesc",t.title)||"",s=i.jp_carousel("parseTitleDesc",t.desc)||"",(o.length||s.length)&&(e("<div />").text(o).html()===e("<div />").text(s).html()&&(o=""),n=o.length?'<div class="jp-carousel-titleanddesc-title">'+o+"</div>":"",n+=s.length?'<div class="jp-carousel-titleanddesc-desc">'+s+"</div>":"",a.html(n).fadeIn("slow")),e("div#jp-carousel-comment-form-container").css("margin-top","20px"),e("div#jp-carousel-comments-loading").css("margin-top","20px")},updateLikesWidgetVisibility:function(t){"undefined"!=typeof jetpackLikesWidgetQueue&&e(".jp-carousel-buttons .jetpack-likes-widget-wrapper").css("display","none").each(function(){var a=e(this);return a.attr("data-attachment-id")==t?(a.css("display","inline-block"),!1):void 0})},loadLikes:function(t){var a=e(".jp-carousel-wrap").data("carousel-extra"),i=a.likes_blog_id;if(0===e("#like-post-wrapper-"+i+"-"+t).length){var o="http",s="http://wordpress.com";if(a.permalink.length){o=a.permalink.split(":")[0],"http"!==o&&"https"!==o&&(o="http");var n=a.permalink.split("/");n.length>=2&&(s=o+"://"+n[2])}var r=o+"://widgets.wp.com/likes/#blog_id="+encodeURIComponent(i)+"&post_id="+encodeURIComponent(t)+"&slim=1&origin="+encodeURIComponent(s);"en"!==jetpackCarouselStrings.lang&&(r+="&lang="+encodeURIComponent(jetpackCarouselStrings.lang));var l=e("<iframe class='post-likes-widget jetpack-likes-widget jetpack-resizeable'></iframe>").attr("name","like-post-frame-"+i+"-"+t).attr("src",r).css("display","inline-block"),c=e("<div/>").addClass("jetpack-likes-widget-wrapper jetpack-likes-widget-unloaded slim-likes-widget").attr("id","like-post-wrapper-"+i+"-"+t).attr("data-src",r).attr("data-name","like-post-frame-"+i+"-"+t).attr("data-attachment-id",t).css("display","none").css("vertical-align","middle").append(l).append("<div class='post-likes-widget-placeholder'></div>");e(".jp-carousel-buttons").append(c)}},updateExif:function(t){if(!t||1!==Number(jetpackCarouselStrings.display_exif))return!1;var a=e("<ul class='jp-carousel-image-exif'></ul>");e.each(t,function(t,o){if(0!==parseFloat(o)&&o.length&&-1!==e.inArray(t,["camera","aperture","shutter_speed","focal_length"])){switch(t){case"focal_length":o+="mm";break;case"shutter_speed":o=i.jp_carousel("shutterSpeed",o);break;case"aperture":o="f/"+o}a.append("<li><h5>"+jetpackCarouselStrings[t]+"</h5>"+o+"</li>")}}),e("div.jp-carousel-image-meta ul.jp-carousel-image-exif").replaceWith(a)},updateFullSizeLink:function(t){if(!t||!t.data)return!1;var a=t.data("orig-file").replace(/\?.+$/,""),o=t.data("orig-size").split(","),s=e("<a>"+i.jp_carousel("format",{text:jetpackCarouselStrings.download_original,replacements:o})+"</a>").addClass("jp-carousel-image-download").attr("href",a).attr("target","_blank");e("div.jp-carousel-image-meta a.jp-carousel-image-download").replaceWith(s)},updateMap:function(t){if(t.latitude&&t.longitude&&1===Number(jetpackCarouselStrings.display_geo)){var a=t.latitude,i=t.longitude,o=e("div.jp-carousel-image-meta","div.jp-carousel-wrap"),s=e("<div></div>"),n="&scale=2&style=feature:all|element:all|invert_lightness:true|hue:0x0077FF|saturation:-50|lightness:-5|gamma:0.91";s.addClass("jp-carousel-image-map").html('<img width="154" height="154" src="https://maps.googleapis.com/maps/api/staticmap?							center='+a+","+i+"&							zoom=8&							size=154x154&							sensor=false&							markers=size:medium%7Ccolor:blue%7C"+a+","+i+n+'" class="gmap-main" />													<div class="gmap-topright"><div class="imgclip"><img width="175" height="154" src="https://maps.googleapis.com/maps/api/staticmap?							center='+a+","+i+"&							zoom=3&							size=175x154&							sensor=false&							markers=size:small%7Ccolor:blue%7C"+a+","+i+n+'"c /></div></div>													').prependTo(o)}},testCommentsOpened:function(t){1===parseInt(t,10)?(e(".jp-carousel-buttons").fadeIn("fast"),j.fadeIn("fast")):(e(".jp-carousel-buttons").fadeOut("fast"),j.fadeOut("fast"))},getComments:function(t){if(clearInterval(m),"object"==typeof t&&"undefined"!=typeof t.attachment_id&&t.attachment_id){(!t.offset||"undefined"==typeof t.offset||t.offset<1)&&(t.offset=0);var a=e(".jp-carousel-comments"),o=e("#jp-carousel-comments-loading").show();t.clear&&a.hide().empty(),e.ajax({type:"GET",url:jetpackCarouselStrings.ajaxurl,dataType:"json",data:{action:"get_attachment_comments",nonce:jetpackCarouselStrings.nonce,id:t.attachment_id,offset:t.offset},success:function(s){t.clear&&a.fadeOut("fast").empty(),e(s).each(function(){var o=e("<div></div>").addClass("jp-carousel-comment").attr("id","jp-carousel-comment-"+this.id).html('<div class="comment-gravatar">'+this.gravatar_markup+'</div><div class="comment-author">'+this.author_markup+'</div><div class="comment-date">'+this.date_gmt+'</div><div class="comment-content">'+this.content+"</div>");a.append(o),clearInterval(m),m=setInterval(function(){e(".jp-carousel-overlay").height()-150<e(".jp-carousel-wrap").scrollTop()+e(window).height()&&(i.jp_carousel("getComments",{attachment_id:t.attachment_id,offset:t.offset+10,clear:!1}),clearInterval(m))},300)});var n=e(".jp-carousel div.selected");return n&&n.data&&n.data("attachment-id")!=t.attachment_id?(a.fadeOut("fast"),void a.empty()):(e(".jp-carousel-overlay").height(e(window).height()+g.height()+j.height()+(a.height()>0?a.height():h.height())+200),a.show(),void o.hide())},error:function(e,t,i){console.log("Comment get fail...",e,t,i),a.fadeIn("fast"),o.fadeOut("fast")}})}},postCommentError:function(t){"object"!=typeof t&&(t={}),t.field&&"undefined"!=typeof t.field&&t.error&&"undefined"!=typeof t.error&&(e("#jp-carousel-comment-post-results").slideUp("fast").html('<span class="jp-carousel-comment-post-error">'+t.error+"</span>").slideDown("fast"),e("#jp-carousel-comment-form-spinner").spin(!1))},setCommentIframeSrc:function(t){var a=e("#jp-carousel-comment-iframe");a&&a.length&&(a.attr("src",a.attr("src").replace(/(postid=)\d+/,"$1"+t)),a.attr("src",a.attr("src").replace(/(%23.+)?$/,"%23jp-carousel-"+t)))},clearCommentTextAreaValue:function(){var t=e("#jp-carousel-comment-form-comment-field");t&&t.val("")},nextSlide:function(){var e=this.jp_carousel("slides"),t=this.jp_carousel("selectedSlide");return 0===t.length||e.length>2&&t.is(e.last())?e.first():t.next()},prevSlide:function(){var e=this.jp_carousel("slides"),t=this.jp_carousel("selectedSlide");return 0===t.length||e.length>2&&t.is(e.first())?e.last():t.prev()},loadFullImage:function(t){var a=t.find("img:first");a.data("loaded")||(a.on("load.jetpack",function(){a.off("load.jetpack"),e(this).closest(".jp-carousel-slide").css("background-image","")}),!t.data("preview-image")||t.data("thumb-size")&&t.width()>t.data("thumb-size").width?a.attr("src",a.closest(".jp-carousel-slide").data("src")):a.attr("src",t.data("preview-image")),a.data("loaded",1))}};e.fn.jp_carousel=function(t){return I[t]?I[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist on jQuery.jp_carousel"):I.open.apply(this,arguments)},e(document.body).on("click","div.gallery,div.tiled-gallery",function(t){e(this).jp_carousel("testForData",t.currentTarget)&&(e(t.target).parent().hasClass("gallery-caption")||(t.preventDefault(),t.stopPropagation(),e(this).jp_carousel("open",{start_index:e(this).find(".gallery-item, .tiled-gallery-item").index(e(t.target).parents(".gallery-item, .tiled-gallery-item"))})))}),e(window).on("hashchange",function(){var t,a,s,n,r=/jp-carousel-(\d+)/;return window.location.hash&&r.test(window.location.hash)?void(window.location.hash===y&&i.opened||(y=window.location.hash,t=window.location.hash.match(r),a=parseInt(t[1],10),s=e("div.gallery, div.tiled-gallery"),s.each(function(t,i){e(i).find("img").each(function(t,o){return e(o).data("attachment-id")===parseInt(a,10)?(n={index:t,gallery:i},!1):void 0}),n&&e(n.gallery).jp_carousel("openOrSelectSlide",n.index)}))):void(i.opened&&o.jp_carousel("close"))}),window.location.hash&&e(window).trigger("hashchange")}),function(e){e.fn.touchwipe=function(t){var a={min_move_x:20,min_move_y:20,wipeLeft:function(){},wipeRight:function(){},wipeUp:function(){},wipeDown:function(){},preventDefaultEvents:!0};return t&&e.extend(a,t),this.each(function(){function e(){this.removeEventListener("touchmove",t),o=null,n=!1}function t(t){if(a.preventDefaultEvents&&t.preventDefault(),n){var i=t.touches[0].pageX,r=t.touches[0].pageY,l=o-i,c=s-r;Math.abs(l)>=a.min_move_x?(e(),l>0?a.wipeLeft(t):a.wipeRight(t)):Math.abs(c)>=a.min_move_y&&(e(),c>0?a.wipeDown(t):a.wipeUp(t))}}function i(e){1===e.touches.length&&(o=e.touches[0].pageX,s=e.touches[0].pageY,n=!0,this.addEventListener("touchmove",t,!1))}var o,s,n=!1;"ontouchstart"in document.documentElement&&this.addEventListener("touchstart",i,!1)}),this}}(jQuery);