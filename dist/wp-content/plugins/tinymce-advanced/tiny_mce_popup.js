var tinymce=null,tinyMCEPopup,tinyMCE;tinyMCEPopup={init:function(){var e,n=this;e=n.getWin(),tinymce=e.tinymce,tinyMCE=e.tinyMCE,n.editor=tinymce.EditorManager.activeEditor,n.params=n.editor.windowManager.params,n.features=n.editor.windowManager.features,n.dom=n.editor.windowManager.createInstance("tinymce.dom.DOMUtils",document,{ownEvents:!0,proxy:tinyMCEPopup._eventProxy}),n.dom.bind(window,"ready",n._onDOMLoaded,n),n.features.popup_css!==!1&&n.dom.loadCSS(n.features.popup_css||n.editor.settings.popup_css),n.listeners=[],n.onInit={add:function(e,t){n.listeners.push({func:e,scope:t})}},n.isWindow=!n.getWindowArg("mce_inline"),n.id=n.getWindowArg("mce_window_id"),n.editor.windowManager.onOpen.dispatch(n.editor.windowManager,window)},getWin:function(){return!window.frameElement&&window.dialogArguments||opener||parent||top},getWindowArg:function(e,n){var t=this.params[e];return tinymce.is(t)?t:n},getParam:function(e,n){return this.editor.getParam(e,n)},getLang:function(e,n){return this.editor.getLang(e,n)},execCommand:function(e,n,t,o){return o=o||{},o.skip_focus=1,this.restoreSelection(),this.editor.execCommand(e,n,t,o)},resizeToInnerSize:function(){var e=this;setTimeout(function(){var n=e.dom.getViewPort(window);e.editor.windowManager.resizeBy(e.getWindowArg("mce_width")-n.w,e.getWindowArg("mce_height")-n.h,e.id||window)},10)},executeOnLoad:function(s){this.onInit.add(function(){eval(s)})},storeSelection:function(){this.editor.windowManager.bookmark=tinyMCEPopup.editor.selection.getBookmark(1)},restoreSelection:function(){var e=tinyMCEPopup;!e.isWindow&&tinymce.isIE&&e.editor.selection.moveToBookmark(e.editor.windowManager.bookmark)},requireLangPack:function(){var e=this,n=e.getWindowArg("plugin_url")||e.getWindowArg("theme_url");n&&e.editor.settings.language&&e.features.translate_i18n!==!1&&e.editor.settings.language_load!==!1&&(n+="/langs/"+e.editor.settings.language+"_dlg.js",tinymce.ScriptLoader.isDone(n)||(document.write('<script type="text/javascript" src="'+tinymce._addVer(n)+'"></script>'),tinymce.ScriptLoader.markDone(n)))},pickColor:function(e,n){this.execCommand("mceColorPicker",!0,{color:document.getElementById(n).value,func:function(e){document.getElementById(n).value=e;try{document.getElementById(n).onchange()}catch(t){}}})},openBrowser:function(e,n,t){tinyMCEPopup.restoreSelection(),this.editor.execCallback("file_browser_callback",e,document.getElementById(e).value,n,window)},confirm:function(e,n,t){this.editor.windowManager.confirm(e,n,t,window)},alert:function(e,n,t){this.editor.windowManager.alert(e,n,t,window)},close:function(){function e(){n.editor.windowManager.close(window),tinymce=tinyMCE=n.editor=n.params=n.dom=n.dom.doc=null}var n=this;tinymce.isOpera?n.getWin().setTimeout(e,0):e()},_restoreSelection:function(){var e=window.event.srcElement;"INPUT"!=e.nodeName||"submit"!=e.type&&"button"!=e.type||tinyMCEPopup.restoreSelection()},_onDOMLoaded:function(){var e,n,t=tinyMCEPopup,o=document.title;t.features.translate_i18n!==!1&&(e=document.body.innerHTML,tinymce.isIE&&(e=e.replace(/ (value|title|alt)=([^"][^\s>]+)/gi,' $1="$2"')),document.dir=t.editor.getParam("directionality",""),(n=t.editor.translate(e))&&n!=e&&(document.body.innerHTML=n),(n=t.editor.translate(o))&&n!=o&&(document.title=o=n)),t.editor.getParam("browser_preferred_colors",!1)&&t.isWindow||t.dom.addClass(document.body,"forceColors"),document.body.style.display="",tinymce.isIE&&(document.attachEvent("onmouseup",tinyMCEPopup._restoreSelection),t.dom.add(t.dom.select("head")[0],"base",{target:"_self"})),t.restoreSelection(),t.resizeToInnerSize(),t.isWindow?window.focus():t.editor.windowManager.setTitle(window,o),tinymce.isIE||t.isWindow||t.dom.bind(document,"focus",function(){t.editor.windowManager.focus(t.id)}),tinymce.each(t.dom.select("select"),function(e){e.onkeydown=tinyMCEPopup._accessHandler}),tinymce.each(t.listeners,function(e){e.func.call(e.scope,t.editor)}),t.getWindowArg("mce_auto_focus",!0)&&(window.focus(),tinymce.each(document.forms,function(e){tinymce.each(e.elements,function(e){return t.dom.hasClass(e,"mceFocus")&&!e.disabled?(e.focus(),!1):void 0})})),document.onkeyup=tinyMCEPopup._closeWinKeyHandler},_accessHandler:function(e){if(e=e||window.event,13==e.keyCode||32==e.keyCode){var n=e.target||e.srcElement;return n.onchange&&n.onchange(),tinymce.dom.Event.cancel(e)}},_closeWinKeyHandler:function(e){e=e||window.event,27==e.keyCode&&tinyMCEPopup.close()},_eventProxy:function(e){return function(n){tinyMCEPopup.dom.events.callNativeHandler(e,n)}}},tinyMCEPopup.init();