!function(e){function t(t,s,r,i){t.value=e(s).text(),e(t).change(),e.browser.msie||t.focus(),r.hide()}function s(e,t){var s=e.getHours(),o=t.show24Hours?s:(s+11)%12+1;o=i(o,t);var n=e.getMinutes(),e=t.timeFormat;return e=e.replace("hh",o),e=e.replace("h",o),e=e.replace("mm",r(n)),e=t.show24Hours?e.replace(" tt",""):e.replace("tt",12>s?t.amDesignator:t.pmDesignator)}function r(e){return(10>e?"0":"")+e}function i(e,t){return t.show24Hours?(10>e?"0":"")+e:e}function o(e,t){return"object"==typeof e?a(e):n(e,t)}function n(e,t){if(e){var s=e.split(t.separator),r=parseFloat(s[0]),i=parseFloat(s[1]);t.show24Hours||(12===r&&-1!==e.substr(t.amDesignator)?r=0:12!==r&&-1!==e.indexOf(t.pmDesignator)&&(r+=12));var o=new Date(0,0,0,r,i,0);return a(o)}return null}function a(e){return e.setFullYear(2001),e.setMonth(0),e.setDate(0),e}e.fn.timePicker=function(t){var s=e.extend({},e.fn.timePicker.defaults,t);return this.each(function(){e.timePicker(this,s)})},e.timePicker=function(t,s){var r=e(t)[0];return r.timePicker||(r.timePicker=new jQuery._timePicker(r,s))},e._timePicker=function(r,i){var l=!1,u=!1,c=o(i.startTime,i),f=o(i.endTime,i);e(r).attr("autocomplete","OFF");for(var d=[],p=new Date(c);f>=p;)d[d.length]=s(p,i),p=new Date(p.setMinutes(p.getMinutes()+i.step));for(var m=e("<div "+(i.tpDivId?'id="'+i.tpDivId+'" ':"")+'class="time-picker'+(i.show24Hours?"":" time-picker-12hours")+'"></div>'),h=e("<ul></ul>"),v=0;v<d.length;v++)h.append("<li>"+d[v]+"</li>");m.append(h);var g=e(r).offset();m.appendTo("body").css({top:g.top-48+"px",left:g.left,width:e(r).width()+5+"px"}).hide(),m.mouseover(function(){l=!0}).mouseout(function(){l=!1}),e("li",h).mouseover(function(){u||(e("li.selected",m).removeClass("selected"),e(this).addClass("selected"))}).mousedown(function(){l=!0}).click(function(){t(r,this,m,i),l=!1});var w=function(){if(m.is(":visible"))return!1;e("li",m).removeClass("selected");var t=e(r).offset();m.css({top:t.top+e(r).height()+10+"px",left:t.left,width:e(r).width()+5+"px"}),m.show();var o=r.value?n(r.value,i):c,l=60*c.getHours()+c.getMinutes(),u=60*o.getHours()+o.getMinutes()-l,d=Math.round(u/i.step),p=a(new Date(0,0,0,0,d*i.step+l,0));p=p>c&&f>=p?p:c;var h=e("li:contains("+s(p,i)+")",m);return h.length&&(h.addClass("selected"),m[0].scrollTop=h[0].offsetTop),!0};e(r).focus(w).click(w),e(r).blur(function(){l||m.hide()});var k=e.browser.opera||e.browser.mozilla?"keypress":"keydown";e(r)[k](function(s){var o;u=!0;var n=m[0].scrollTop;switch(s.keyCode){case 38:if(w())return!1;o=e("li.selected",h);var a=o.prev().addClass("selected")[0];return a?(o.removeClass("selected"),a.offsetTop<n&&(m[0].scrollTop=n-a.offsetHeight)):(o.removeClass("selected"),a=e("li:last",h).addClass("selected")[0],m[0].scrollTop=a.offsetTop-a.offsetHeight),!1;case 40:if(w())return!1;o=e("li.selected",h);var l=o.next().addClass("selected")[0];return l?(o.removeClass("selected"),l.offsetTop+l.offsetHeight>n+m[0].offsetHeight&&(m[0].scrollTop=n+l.offsetHeight)):(o.removeClass("selected"),l=e("li:first",h).addClass("selected")[0],m[0].scrollTop=0),!1;case 13:if(m.is(":visible")){var c=e("li.selected",h)[0];t(r,c,m,i)}return!1;case 27:return m.hide(),!1}return!0}),e(r).keyup(function(e){u=!1}),this.getTime=function(){return n(r.value,i)},this.setTime=function(t){r.value=s(a(t),i),e(r).change()}},e.fn.timePicker.defaults={step:30,startTime:new Date(0,0,0,0,0,0),endTime:new Date(0,0,0,23,30,0),separator:":",show24Hours:!0,timeFormat:"hh:mm tt",amDesignator:"AM",pmDesignator:"PM"}}(jQuery);