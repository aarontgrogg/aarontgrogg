"undefined"!=typeof dojo&&dojo.provide("MochiKit.Base"),"undefined"==typeof MochiKit&&(MochiKit={}),"undefined"==typeof MochiKit.Base&&(MochiKit.Base={}),MochiKit.Base.VERSION="1.3.1",MochiKit.Base.NAME="MochiKit.Base",MochiKit.Base.update=function(r,e){null===r&&(r={});for(var t=1;t<arguments.length;t++){var n=arguments[t];if("undefined"!=typeof n&&null!==n)for(var i in n)r[i]=n[i]}return r},MochiKit.Base.update(MochiKit.Base,{__repr__:function(){return"["+this.NAME+" "+this.VERSION+"]"},toString:function(){return this.__repr__()},counter:function(r){return 0===arguments.length&&(r=1),function(){return r++}},clone:function(r){var e=arguments.callee;return 1==arguments.length?(e.prototype=r,new e):void 0},flattenArguments:function(r){for(var e=[],t=MochiKit.Base,n=t.extend(null,arguments);n.length;){var i=n.shift();if(i&&"object"==typeof i&&"number"==typeof i.length)for(var o=i.length-1;o>=0;o--)n.unshift(i[o]);else e.push(i)}return e},extend:function(r,e,t){if(t||(t=0),e){var n=e.length;if("number"!=typeof n){if("undefined"==typeof MochiKit.Iter)throw new TypeError("Argument not an array-like and MochiKit.Iter not present");e=MochiKit.Iter.list(e),n=e.length}r||(r=[]);for(var i=t;n>i;i++)r.push(e[i])}return r},updatetree:function(r,e){null===r&&(r={});for(var t=1;t<arguments.length;t++){var n=arguments[t];if("undefined"!=typeof n&&null!==n)for(var i in n){var o=n[i];"object"==typeof r[i]&&"object"==typeof o?arguments.callee(r[i],o):r[i]=o}}return r},setdefault:function(r,e){null===r&&(r={});for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)i in r||(r[i]=n[i])}return r},keys:function(r){var e=[];for(var t in r)e.push(t);return e},items:function(r){var e=[];for(var t in r){var n;try{n=r[t]}catch(i){continue}e.push([t,n])}return e},_newNamedError:function(r,e,t){t.prototype=new MochiKit.Base.NamedError(r.NAME+"."+e),r[e]=t},operator:{truth:function(r){return!!r},lognot:function(r){return!r},identity:function(r){return r},not:function(r){return~r},neg:function(r){return-r},add:function(r,e){return r+e},sub:function(r,e){return r-e},div:function(r,e){return r/e},mod:function(r,e){return r%e},mul:function(r,e){return r*e},and:function(r,e){return r&e},or:function(r,e){return r|e},xor:function(r,e){return r^e},lshift:function(r,e){return r<<e},rshift:function(r,e){return r>>e},zrshift:function(r,e){return r>>>e},eq:function(r,e){return r==e},ne:function(r,e){return r!=e},gt:function(r,e){return r>e},ge:function(r,e){return r>=e},lt:function(r,e){return e>r},le:function(r,e){return e>=r},ceq:function(r,e){return 0===MochiKit.Base.compare(r,e)},cne:function(r,e){return 0!==MochiKit.Base.compare(r,e)},cgt:function(r,e){return 1==MochiKit.Base.compare(r,e)},cge:function(r,e){return-1!=MochiKit.Base.compare(r,e)},clt:function(r,e){return-1==MochiKit.Base.compare(r,e)},cle:function(r,e){return 1!=MochiKit.Base.compare(r,e)},logand:function(r,e){return r&&e},logor:function(r,e){return r||e},contains:function(r,e){return e in r}},forwardCall:function(r){return function(){return this[r].apply(this,arguments)}},itemgetter:function(r){return function(e){return e[r]}},typeMatcher:function(){for(var r={},e=0;e<arguments.length;e++){var t=arguments[e];r[t]=t}return function(){for(var e=0;e<arguments.length;e++)if(!(typeof arguments[e]in r))return!1;return!0}},isNull:function(){for(var r=0;r<arguments.length;r++)if(null!==arguments[r])return!1;return!0},isUndefinedOrNull:function(){for(var r=0;r<arguments.length;r++){var e=arguments[r];if("undefined"!=typeof e&&null!==e)return!1}return!0},isEmpty:function(r){return!MochiKit.Base.isNotEmpty.apply(this,arguments)},isNotEmpty:function(r){for(var e=0;e<arguments.length;e++){var t=arguments[e];if(!t||!t.length)return!1}return!0},isArrayLike:function(){for(var r=0;r<arguments.length;r++){var e=arguments[r],t=typeof e;if("object"!=t&&("function"!=t||"function"!=typeof e.item)||null===e||"number"!=typeof e.length)return!1}return!0},isDateLike:function(){for(var r=0;r<arguments.length;r++){var e=arguments[r];if("object"!=typeof e||null===e||"function"!=typeof e.getTime)return!1}return!0},xmap:function(r){if(null===r)return MochiKit.Base.extend(null,arguments,1);for(var e=[],t=1;t<arguments.length;t++)e.push(r(arguments[t]));return e},map:function(r,e){var t=MochiKit.Base,n=MochiKit.Iter,i=t.isArrayLike;if(arguments.length<=2){if(!i(e)){if(!n)throw new TypeError("Argument not an array-like and MochiKit.Iter not present");if(e=n.list(e),null===r)return e}if(null===r)return t.extend(null,e);for(var o=[],a=0;a<e.length;a++)o.push(r(e[a]));return o}null===r&&(r=Array);var u=null;for(a=1;a<arguments.length;a++){if(!i(arguments[a])){if(n)return n.list(n.imap.apply(null,arguments));throw new TypeError("Argument not an array-like and MochiKit.Iter not present")}var f=arguments[a].length;(null===u||u>f)&&(u=f)}for(o=[],a=0;u>a;a++){for(var s=[],c=1;c<arguments.length;c++)s.push(arguments[c][a]);o.push(r.apply(this,s))}return o},xfilter:function(r){var e=[];null===r&&(r=MochiKit.Base.operator.truth);for(var t=1;t<arguments.length;t++){var n=arguments[t];r(n)&&e.push(n)}return e},filter:function(r,e,t){var n=[],i=MochiKit.Base;if(!i.isArrayLike(e)){if(!MochiKit.Iter)throw new TypeError("Argument not an array-like and MochiKit.Iter not present");e=MochiKit.Iter.list(e)}if(null===r&&(r=i.operator.truth),"function"==typeof Array.prototype.filter)return Array.prototype.filter.call(e,r,t);if("undefined"==typeof t||null===t)for(var o=0;o<e.length;o++){var a=e[o];r(a)&&n.push(a)}else for(o=0;o<e.length;o++)a=e[o],r.call(t,a)&&n.push(a);return n},_wrapDumbFunction:function(func){return function(){switch(arguments.length){case 0:return func();case 1:return func(arguments[0]);case 2:return func(arguments[0],arguments[1]);case 3:return func(arguments[0],arguments[1],arguments[2])}for(var args=[],i=0;i<arguments.length;i++)args.push("arguments["+i+"]");return eval("(func("+args.join(",")+"))")}},method:function(r,e){var t=MochiKit.Base;return t.bind.apply(this,t.extend([e,r],arguments,2))},bind:function(r,e){"string"==typeof r&&(r=e[r]);var t=r.im_func,n=r.im_preargs,i=r.im_self,o=MochiKit.Base;"function"==typeof r&&"undefined"==typeof r.apply&&(r=o._wrapDumbFunction(r)),"function"!=typeof t&&(t=r),"undefined"!=typeof e&&(i=e),n="undefined"==typeof n?[]:n.slice(),o.extend(n,arguments,2);var a=function(){var r=arguments,e=arguments.callee;e.im_preargs.length>0&&(r=o.concat(e.im_preargs,r));var t=e.im_self;return t||(t=this),e.im_func.apply(t,r)};return a.im_self=i,a.im_func=t,a.im_preargs=n,a},bindMethods:function(r){var e=MochiKit.Base.bind;for(var t in r){var n=r[t];"function"==typeof n&&(r[t]=e(n,r))}},registerComparator:function(r,e,t,n){MochiKit.Base.comparatorRegistry.register(r,e,t,n)},_primitives:{"boolean":!0,string:!0,number:!0},compare:function(r,e){if(r==e)return 0;var t="undefined"==typeof r||null===r,n="undefined"==typeof e||null===e;if(t&&n)return 0;if(t)return-1;if(n)return 1;var i=MochiKit.Base,o=i._primitives;if(!(typeof r in o&&typeof e in o))try{return i.comparatorRegistry.match(r,e)}catch(a){if(a!=i.NotFound)throw a}if(e>r)return-1;if(r>e)return 1;var u=i.repr;throw new TypeError(u(r)+" and "+u(e)+" can not be compared")},compareDateLike:function(r,e){return MochiKit.Base.compare(r.getTime(),e.getTime())},compareArrayLike:function(r,e){var t=MochiKit.Base.compare,n=r.length,i=0;n>e.length?(i=1,n=e.length):n<e.length&&(i=-1);for(var o=0;n>o;o++){var a=t(r[o],e[o]);if(a)return a}return i},registerRepr:function(r,e,t,n){MochiKit.Base.reprRegistry.register(r,e,t,n)},repr:function(r){if("undefined"==typeof r)return"undefined";if(null===r)return"null";try{return"function"==typeof r.__repr__?r.__repr__():"function"==typeof r.repr&&r.repr!=arguments.callee?r.repr():MochiKit.Base.reprRegistry.match(r)}catch(e){if("string"==typeof r.NAME&&(r.toString==Function.prototype.toString||r.toString==Object.prototype.toString))return r.NAME}try{var t=r+""}catch(e){return"["+typeof r+"]"}if("function"==typeof r){r=t.replace(/^\s+/,"");var n=r.indexOf("{");-1!=n&&(r=r.substr(0,n)+"{...}")}return t},reprArrayLike:function(r){var e=MochiKit.Base;return"["+e.map(e.repr,r).join(", ")+"]"},reprString:function(r){return('"'+r.replace(/(["\\])/g,"\\$1")+'"').replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")},reprNumber:function(r){return r+""},registerJSON:function(r,e,t,n){MochiKit.Base.jsonRegistry.register(r,e,t,n)},evalJSON:function(){return eval("("+arguments[0]+")")},serializeJSON:function(r){var e=typeof r;if("undefined"==e)return"undefined";if("number"==e||"boolean"==e)return r+"";if(null===r)return"null";var t=MochiKit.Base,n=t.reprString;if("string"==e)return n(r);var i,o=arguments.callee;if("function"==typeof r.__json__&&(i=r.__json__(),r!==i))return o(i);if("function"==typeof r.json&&(i=r.json(),r!==i))return o(i);if("function"!=e&&"number"==typeof r.length){for(var a=[],u=0;u<r.length;u++){var f=o(r[u]);"string"!=typeof f&&(f="undefined"),a.push(f)}return"["+a.join(", ")+"]"}try{return i=t.jsonRegistry.match(r),o(i)}catch(s){if(s!=t.NotFound)throw s}if("function"==e)return null;a=[];for(var c in r){var p;if("number"==typeof c)p='"'+c+'"';else{if("string"!=typeof c)continue;p=n(c)}f=o(r[c]),"string"==typeof f&&a.push(p+":"+f)}return"{"+a.join(", ")+"}"},objEqual:function(r,e){return 0===MochiKit.Base.compare(r,e)},arrayEqual:function(r,e){return r.length!=e.length?!1:0===MochiKit.Base.compare(r,e)},concat:function(){for(var r=[],e=MochiKit.Base.extend,t=0;t<arguments.length;t++)e(r,arguments[t]);return r},keyComparator:function(r){var e=MochiKit.Base,t=e.compare;if(1==arguments.length)return function(e,n){return t(e[r],n[r])};var n=e.extend(null,arguments);return function(r,e){for(var i=0,o=0;0===i&&o<n.length;o++){var a=n[o];i=t(r[a],e[a])}return i}},reverseKeyComparator:function(r){var e=MochiKit.Base.keyComparator.apply(this,arguments);return function(r,t){return e(t,r)}},partial:function(r){var e=MochiKit.Base;return e.bind.apply(this,e.extend([r,void 0],arguments,1))},listMinMax:function(r,e){if(0===e.length)return null;for(var t=e[0],n=MochiKit.Base.compare,i=1;i<e.length;i++){var o=e[i];n(o,t)==r&&(t=o)}return t},objMax:function(){return MochiKit.Base.listMinMax(1,arguments)},objMin:function(){return MochiKit.Base.listMinMax(-1,arguments)},findIdentical:function(r,e,t,n){("undefined"==typeof n||null===n)&&(n=r.length);for(var i=t||0;n>i;i++)if(r[i]===e)return i;return-1},findValue:function(r,e,t,n){("undefined"==typeof n||null===n)&&(n=r.length);for(var i=MochiKit.Base.compare,o=t||0;n>o;o++)if(0===i(r[o],e))return o;return-1},nodeWalk:function(r,e){for(var t=[r],n=MochiKit.Base.extend;t.length;){var i=e(t.shift());i&&n(t,i)}},nameFunctions:function(r){var e=r.NAME;"undefined"==typeof e?e="":e+=".";for(var t in r){var n=r[t];if("function"==typeof n&&"undefined"==typeof n.NAME)try{n.NAME=e+t}catch(i){}}},queryString:function(r,e){if("undefined"!=typeof MochiKit.DOM&&1==arguments.length&&("string"==typeof r||"undefined"!=typeof r.nodeType&&r.nodeType>0)){var t=MochiKit.DOM.formContents(r);r=t[0],e=t[1]}else if(1==arguments.length){var n=r;r=[],e=[];for(var i in n){var o=n[i];"function"!=typeof o&&(r.push(i),e.push(o))}}for(var a=[],u=Math.min(r.length,e.length),f=MochiKit.Base.urlEncode,s=0;u>s;s++)o=e[s],"undefined"!=typeof o&&null!==o&&a.push(f(r[s])+"="+f(o));return a.join("&")},parseQueryString:function(r,e){var t,n=r.replace(/\+/g,"%20").split("&"),i={};if(t="undefined"!=typeof decodeURIComponent?decodeURIComponent:unescape,e)for(var o=0;o<n.length;o++){var a=n[o].split("="),u=t(a[0]),f=i[u];f instanceof Array||(f=[],i[u]=f),f.push(t(a[1]))}else for(o=0;o<n.length;o++)a=n[o].split("="),i[t(a[0])]=t(a[1]);return i}}),MochiKit.Base.AdapterRegistry=function(){this.pairs=[]},MochiKit.Base.AdapterRegistry.prototype={register:function(r,e,t,n){n?this.pairs.unshift([r,e,t]):this.pairs.push([r,e,t])},match:function(){for(var r=0;r<this.pairs.length;r++){var e=this.pairs[r];if(e[1].apply(this,arguments))return e[2].apply(this,arguments)}throw MochiKit.Base.NotFound},unregister:function(r){for(var e=0;e<this.pairs.length;e++){var t=this.pairs[e];if(t[0]==r)return this.pairs.splice(e,1),!0}return!1}},MochiKit.Base.EXPORT=["counter","clone","extend","update","updatetree","setdefault","keys","items","NamedError","operator","forwardCall","itemgetter","typeMatcher","isCallable","isUndefined","isUndefinedOrNull","isNull","isEmpty","isNotEmpty","isArrayLike","isDateLike","xmap","map","xfilter","filter","bind","bindMethods","NotFound","AdapterRegistry","registerComparator","compare","registerRepr","repr","objEqual","arrayEqual","concat","keyComparator","reverseKeyComparator","partial","merge","listMinMax","listMax","listMin","objMax","objMin","nodeWalk","zip","urlEncode","queryString","serializeJSON","registerJSON","evalJSON","parseQueryString","findValue","findIdentical","flattenArguments","method"],MochiKit.Base.EXPORT_OK=["nameFunctions","comparatorRegistry","reprRegistry","jsonRegistry","compareDateLike","compareArrayLike","reprArrayLike","reprString","reprNumber"],MochiKit.Base._exportSymbols=function(r,e){if("undefined"==typeof MochiKit.__export__&&(MochiKit.__export__=MochiKit.__compat__||"undefined"==typeof JSAN&&"undefined"==typeof dojo),MochiKit.__export__)for(var t=e.EXPORT_TAGS[":all"],n=0;n<t.length;n++)r[t[n]]=e[t[n]]},MochiKit.Base.__new__=function(){var r=this;r.forward=r.forwardCall,r.find=r.findValue,"undefined"!=typeof encodeURIComponent?r.urlEncode=function(r){return encodeURIComponent(r).replace(/\'/g,"%27")}:r.urlEncode=function(r){return escape(r).replace(/\+/g,"%2B").replace(/\"/g,"%22").rval.replace(/\'/g,"%27")},r.NamedError=function(r){this.message=r,this.name=r},r.NamedError.prototype=new Error,r.update(r.NamedError.prototype,{repr:function(){return this.message&&this.message!=this.name?this.name+"("+r.repr(this.message)+")":this.name+"()"},toString:r.forwardCall("repr")}),r.NotFound=new r.NamedError("MochiKit.Base.NotFound"),r.listMax=r.partial(r.listMinMax,1),r.listMin=r.partial(r.listMinMax,-1),r.isCallable=r.typeMatcher("function"),r.isUndefined=r.typeMatcher("undefined"),r.merge=r.partial(r.update,null),r.zip=r.partial(r.map,null),r.comparatorRegistry=new r.AdapterRegistry,r.registerComparator("dateLike",r.isDateLike,r.compareDateLike),r.registerComparator("arrayLike",r.isArrayLike,r.compareArrayLike),r.reprRegistry=new r.AdapterRegistry,r.registerRepr("arrayLike",r.isArrayLike,r.reprArrayLike),r.registerRepr("string",r.typeMatcher("string"),r.reprString),r.registerRepr("numbers",r.typeMatcher("number","boolean"),r.reprNumber),r.jsonRegistry=new r.AdapterRegistry;var e=r.concat(r.EXPORT,r.EXPORT_OK);r.EXPORT_TAGS={":common":r.concat(r.EXPORT_OK),":all":e},r.nameFunctions(this)},MochiKit.Base.__new__(),MochiKit.__compat__||(compare=MochiKit.Base.compare),MochiKit.Base._exportSymbols(this,MochiKit.Base);